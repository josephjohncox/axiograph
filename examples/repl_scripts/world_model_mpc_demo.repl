# Axiograph REPL script: world model MPC demo
#
# Run (from repo root):
#   make binaries
#   ./bin/axiograph repl --script examples/repl_scripts/world_model_mpc_demo.repl
#
# Or (if installed to PATH):
#   axiograph repl --script examples/repl_scripts/world_model_mpc_demo.repl
#
# Notes:
# - This script is used by offline CI/e2e tests, so it uses the `stub` world-model backend
#   (deterministic, no network/secrets).
# - For an LLM-backed run, replace `wm use stub` with:
#     wm use llm
#   and configure one of:
#     export WORLD_MODEL_BACKEND=openai   export OPENAI_API_KEY=...
#     export WORLD_MODEL_BACKEND=anthropic export ANTHROPIC_API_KEY=...
#     export WORLD_MODEL_BACKEND=ollama   (ollama serve)

import_axi examples/Family.axi
wm use stub
wm plan build/world_model_mpc_demo_plan.json --steps 2 --rollouts 2 --goal "predict missing parent links" --axi examples/Family.axi --cq "has_parent=select ?p where ?p is Person limit 1"

# Export the resulting snapshot (PathDBExportV1) so e2e tests can certify a query.
export_axi build/world_model_mpc_export_v1.axi
save build/world_model_mpc.axpd
